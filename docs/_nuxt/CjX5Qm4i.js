const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./aTa61G_T.js","./CqkleIqs.js","./CQgsVD5f.js"])))=>i.map(i=>d[i]);
import{l as ge,j as g,k as E,c as s,m as he,q as G,s as q,v as pe,o as l,a as e,_ as ye,x as P,y as te,d as be,t as r,z as F,A,B as ie,F as C,r as N,C as ke,D as xe,E as _e,b as R,G as Y,w as O,H as W,I as $e,J as Pe,K as B,L as we}from"./DaFax6zv.js";import{_ as Ie,F as Se}from"./CwxdhAuz.js";import{u as ne}from"./Dy5vHOQZ.js";import"./DSCUO0ru.js";const Te=Symbol.for("nuxt:client-only"),Ce=ge({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(t,{slots:h,attrs:p}){const m=g(!1);return E(()=>{m.value=!0}),he(Te,!0),k=>{var d;if(m.value)return(d=h.default)==null?void 0:d.call(h);const y=h.fallback||h.placeholder;if(y)return y();const v=k.fallback||k.placeholder||"",c=k.fallbackTag||k.placeholderTag||"span";return s(c,p,v)}}}),Le={id:"loading","aria-hidden":"true"},Me={__name:"Loading",props:{loading:{type:Boolean,required:!0}},setup(t){return E(async()=>{await G();const h=document.getElementById("loading"),p=document.querySelector(".loading-wave");h&&p&&(p.classList.add("active"),await G(),h.classList.add("active"))}),(h,p)=>q((l(),s("div",Le,p[0]||(p[0]=[e("div",{class:"loading-wave"},null,-1),e("p",null,"載入中...",-1)]),512)),[[pe,t.loading]])}},De={key:0,class:"modal"},Re={class:"modal-wrapper"},Ne={class:"model-content"},Oe={__name:"Modal",props:{isOpen:Boolean},setup(t){return(h,p)=>t.isOpen?(l(),s("div",De,[e("div",Re,[e("span",{class:"close",onClick:p[0]||(p[0]=m=>h.$emit("close"))},"×"),e("div",Ne,[te(h.$slots,"default",{},void 0,!0)])])])):P("",!0)}},Ae=ye(Oe,[["__scopeId","data-v-e17ff7bf"]]),Ee={class:"geo-label","aria-hidden":"true"},He={class:"figure shrink-0 w-full h-48 lg:w-[200px] lg:h-[200px] *:w-full *:h-full"},je=["src","alt"],Ve={class:"p-2"},ee={__name:"Card",props:{item:Object},emits:["click"],setup(t,{emit:h}){const m=ne().domainUrl,k=h;return(y,v)=>(l(),s("li",{class:"card overflow-hidden rounded-xl bg-white shadow-md max-w-[480px] lg:flex",onClick:v[0]||(v[0]=c=>k("click",t.item))},[e("span",Ee,[v[1]||(v[1]=e("svg",{class:"geo-label-icon",role:"presentation","aria-hidden":"true"},[e("use",{href:"#pin"})],-1)),be(" "+r(t.item.Region)+r(t.item.Town),1)]),e("figure",He,[e("img",{src:t.item.Pictures[0]||`${F(m)}/images/default.webp`,alt:t.item.Name},null,8,je)]),e("div",Ve,[te(y.$slots,"default")])]))}},Be={key:0},qe={class:"text-2xl font-bold mb-2"},Fe={class:"relative w-8 h-8 my-1"},Je=["data-id"],Ue={class:"model-photos flex"},ze=["href"],We=["src","alt","title"],Ge={class:"mb-2"},Xe={key:0,class:"mb-2"},Ze={key:1,class:"mb-2"},Ke={class:"mb-2"},Qe={key:1,class:"mb-2"},Ye={class:"list-disc mb-2"},et={key:3},tt={key:4},it={key:5,class:"mb-2"},nt=["href"],lt={key:1},st={__name:"DetailHotel",props:{item:Object},setup(t){const h=t,p=A(()=>h.item??{}),m=g(!1);E(()=>{const c=JSON.parse(localStorage.getItem("favorites")||"[]");m.value=c.some(d=>d.type==="hotel"&&d.Id===item.Id)});const k=p.value.Serviceinfo?p.value.Serviceinfo.split(",").filter(c=>c.trim()!==""):[],y=p.value.Spec?p.value.Spec.split(";").filter(c=>c.trim()!=="").join("、"):"",v=c=>{const d=JSON.parse(localStorage.getItem("favorites")||"[]"),$=c.currentTarget.getAttribute("data-id"),f=c.currentTarget;if(m.value){const w=d.filter(I=>!(I.type==="hotel"&&I.Id===$));localStorage.setItem("favorites",JSON.stringify(w)),m.value=!1}else d.push({...p.value,type:"hotel"}),localStorage.setItem("favorites",JSON.stringify(d)),m.value=!0,f.classList.add("animate"),setTimeout(()=>{f.classList.remove("animate")},300)};return(c,d)=>{var $,f,w,I,T,L;return t.item?(l(),s("div",Be,[e("h2",qe,r(t.item.Name),1),e("div",Fe,[e("button",{onClick:d[0]||(d[0]=_=>v(_)),class:"heart-icon w-8 h-8 bg-transparent rounded-full flex items-center justify-center cursor-pointer transition-transform duration-300 focus:outline-none","aria-label":"加入收藏","data-id":t.item.Id},[(l(),s("svg",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:ie(["h-6 w-6",{"text-rose-500":m.value,"text-gray-300":!m.value,"fill-rose-500":m.value,"fill-gray-300":!m.value}])},d[1]||(d[1]=[e("use",{href:"#heart"},null,-1)]),2))],8,Je)]),e("address",null,r(t.item.Add),1),e("div",Ue,[(l(!0),s(C,null,N(t.item.Pictures,(_,D)=>(l(),s("figure",null,[e("a",{href:_,target:"_blank",rel:"noopener noreferrer"},[(l(),s("img",{key:D,src:_,alt:t.item.PicDescribes[D]||"業主提供的住宿環境照片",title:t.item.PicDescribes[D]||""},null,8,We))],8,ze)]))),256))]),e("p",Ge,r(t.item.Description||""),1),($=t.item)!=null&&$.LowestPrice?(l(),s(C,{key:0},[t.item.LowestPrice===t.item.CeilingPrice?(l(),s("p",Xe,"價位："+r(t.item.CeilingPrice)+" 元。",1)):(l(),s("p",Ze,"價位："+r(t.item.LowestPrice)+" ~ "+r(t.item.CeilingPrice)+" 元。",1))],64)):P("",!0),e("p",Ke,"房間數："+r((f=t.item)==null?void 0:f.TotalNumberofRooms),1),F(y)?(l(),s("p",Qe,"特殊房型與價格："+r(F(y)),1)):P("",!0),(w=t.item)!=null&&w.Serviceinfo?(l(),s(C,{key:2},[d[2]||(d[2]=e("h3",{class:"text-lg font-bold"},"服務：",-1)),e("ul",Ye,[(l(!0),s(C,null,N(F(k),(_,D)=>(l(),s("li",{key:D},r(_),1))),128))])],64)):P("",!0),(I=t.item)!=null&&I.Tel?(l(),s("p",et,"電話："+r(t.item.Tel),1)):P("",!0),(T=t.item)!=null&&T.IndustryEmail?(l(),s("p",tt,"Email："+r(t.item.IndustryEmail),1)):P("",!0),(L=t.item)!=null&&L.Website?(l(),s("p",it,[e("a",{class:"text-sky-600",href:t.item.Website,target:"_blank",rel:"noopener noreferrer"},"商家網站",8,nt)])):P("",!0)])):(l(),s("div",lt,d[3]||(d[3]=[e("p",null,"沒有資料",-1)])))}}},at={key:0},ot={class:"text-2xl font-bold mb-2"},rt={class:"relative w-8 h-8 my-1"},ct=["data-id"],ut={class:"model-photos flex"},dt=["href"],mt=["src","alt","title"],vt={class:"mb-2"},ft={key:0,class:"mb-2"},gt={key:1,class:"mb-2"},ht={key:2,class:"mb-2"},pt={key:3,class:"mb-2"},yt={key:4,class:"mb-2"},bt={key:5,class:"mb-2"},kt=["href"],xt={key:6,class:"mb-2"},_t={key:1},$t={__name:"DetailScenic",props:{item:Object},setup(t){const h=t,p=A(()=>h.item??{}),m=g(!1);E(()=>{const y=JSON.parse(localStorage.getItem("favorites")||"[]");m.value=y.some(v=>v.type==="scenic"&&v.Id===item.Id)});const k=y=>{const v=JSON.parse(localStorage.getItem("favorites")||"[]"),c=y.currentTarget.getAttribute("data-id"),d=y.currentTarget;if(m.value){const $=v.filter(f=>!(f.type==="scenic"&&f.Id===c));localStorage.setItem("favorites",JSON.stringify($)),m.value=!1}else v.push({...p.value,type:"scenic"}),localStorage.setItem("favorites",JSON.stringify(v)),m.value=!0,d.classList.add("animate"),setTimeout(()=>{d.classList.remove("animate")},300)};return(y,v)=>{var c,d,$,f,w,I,T;return t.item?(l(),s("div",at,[e("h2",ot,r(t.item.Name),1),e("div",rt,[e("button",{onClick:v[0]||(v[0]=L=>k(L)),class:"heart-icon w-8 h-8 bg-transparent rounded-full flex items-center justify-center cursor-pointer transition-transform duration-300 focus:outline-none","aria-label":"加入收藏","data-id":t.item.Id},[(l(),s("svg",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:ie(["h-6 w-6",{"text-rose-500":m.value,"text-gray-300":!m.value,"fill-rose-500":m.value,"fill-gray-300":!m.value}])},v[1]||(v[1]=[e("use",{href:"#heart"},null,-1)]),2))],8,ct)]),e("address",null,r(t.item.Add),1),e("div",ut,[(l(!0),s(C,null,N(t.item.Pictures,(L,_)=>(l(),s("figure",null,[e("a",{href:L,target:"_blank",rel:"noopener noreferrer"},[(l(),s("img",{key:_,src:L,alt:t.item.PicDescribes[_]||t.item.Name,title:t.item.PicDescribes[_]||""},null,8,mt))],8,dt)]))),256))]),e("p",vt,r(t.item.Toldescribe||""),1),(c=t.item)!=null&&c.Opentime?(l(),s("p",ft,"開放時間："+r(t.item.Opentime),1)):P("",!0),(d=t.item)!=null&&d.Ticketinfo?(l(),s("p",gt,"入場費："+r(t.item.Ticketinfo),1)):P("",!0),($=t.item)!=null&&$.Travellinginfo?(l(),s("p",ht,"大眾交通資訊："+r(t.item.Travellinginfo),1)):P("",!0),(f=t.item)!=null&&f.Parkinginfo?(l(),s("p",pt,"停車資訊："+r(t.item.Parkinginfo),1)):P("",!0),(w=t.item)!=null&&w.Tel?(l(),s("p",yt,"電話："+r(t.item.Tel),1)):P("",!0),(I=t.item)!=null&&I.Website?(l(),s("p",bt,[e("a",{class:"text-sky-600",href:t.item.Website,target:"_blank",rel:"noopener noreferrer"},"官方網站",8,kt)])):P("",!0),(T=t.item)!=null&&T.Remarks?(l(),s("p",xt,"注意事項："+r(t.item.Remarks),1)):P("",!0)])):(l(),s("div",_t,v[2]||(v[2]=[e("p",null,"沒有資料",-1)])))}}},Pt={class:"text-center pb-5"},wt={key:0,id:"hotel-area",class:"pt-5"},It={class:"text-center mb-5"},St={for:"city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},Tt=["value"],Ct={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Lt={class:"title text-2xl font-bold mb-2"},Mt={class:"min-h-[48px]"},Dt=["innerHTML"],Rt={key:1,id:"scenic-area",class:"pt-5"},Nt={class:"text-center mb-5"},Ot={for:"scenic-city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},At=["value"],Et={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Ht={class:"title text-xl font-bold mb-2"},jt={class:"min-h-[48px]"},Vt={class:"text-2xl"},Bt={class:"range-wrap",style:{"--min":"5","--max":"20","--val":"10"}},qt={for:"range-input"},Ft={id:"description"},Xt={__name:"index",setup(t){const h=ne(),p=h.domainUrl;g("台灣住宿與景點資訊"),g("根據政府提供的資訊，從景點附近整理出台灣各地的民宿、旅店、旅館。");const m=g([]),k=g([]),y=g([]),v=g(!0),c=g(""),d=g([]),$=g(!0);g(null),g(null);const f=g(null),w=g("");g([]);const I=g([]),T=g(10),L=g([]),_=g(!0),D=g(!0),H=g({iconUrl:`${p}/images/taiwan/home.svg`,iconSize:[27,24],iconAnchor:[14,14]}),j=g({iconUrl:`${p}/images/taiwan/pin.svg`,iconSize:[21,28],iconAnchor:[10,18]});let S,b;const J=ke(),le=_e(),se=A(()=>c.value?k.value.filter(a=>a.Region===c.value):m.value),ae=A(()=>$.value?m.value.slice(0,15):se.value),oe=A(()=>c.value?y.value.filter(a=>a.Region===c.value):y.value.slice(0,15));function re(){_.value=!_.value,c.value||($.value=!0)}function X(a,n){let o=a.length,i,x;for(;o;)x=Math.floor(ce(n)*o--),i=a[o],a[o]=a[x],a[x]=i,++n;return a}function ce(a){const n=Math.sin(a)*1e4;return n-Math.floor(n)}function ue(a,n,o,i){const u=(o-a)*Math.PI/180,M=(i-n)*Math.PI/180,z=Math.sin(u/2)*Math.sin(u/2)+Math.cos(a*Math.PI/180)*Math.cos(o*Math.PI/180)*Math.sin(M/2)*Math.sin(M/2);return 6371*(2*Math.atan2(Math.sqrt(z),Math.sqrt(1-z)))}function Z(){if(!f.value)return;const n=w.value==="hotel"?y.value:k.value;I.value=n.filter(o=>ue(f.value.Py,f.value.Px,o.Py,o.Px)<=T.value),L.value=I.value.map(o=>[o.Py,o.Px,{name:o.Name}]),ve()}function K(a,n){f.value=a,w.value=n,Z(),G(()=>{me(a.Py,a.Px)})}function de(){f.value=null}async function me(a,n){b||(b=await B(()=>import("./aTa61G_T.js").then(M=>M.l),__vite__mapDeps([0,1]),import.meta.url).then(M=>M.default)),await B(()=>import("./CQgsVD5f.js").then(M=>M.l),__vite__mapDeps([2,1]),import.meta.url),S&&S.remove();const o=w.value==="hotel",i=o?b.icon(H.value):b.icon(j.value),x=o?b.icon(j.value):b.icon(H.value);S=b.map("map").setView([a,n],13),b.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:10,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(S),b.marker([a,n],{icon:i}).addTo(S).bindPopup(f.value.Name).openPopup(),Q(x,o)}async function ve(){if(b||(b=await B(()=>import("./aTa61G_T.js").then(i=>i.l),__vite__mapDeps([0,1]),import.meta.url).then(i=>i.default)),await B(()=>import("./CQgsVD5f.js").then(i=>i.l),__vite__mapDeps([2,1]),import.meta.url),!S||(S.eachLayer(i=>{i instanceof b.Marker&&S.removeLayer(i)}),!f.value))return;const a=w.value==="hotel",n=a?b.icon(H.value):b.icon(j.value),o=a?b.icon(j.value):b.icon(H.value);b.marker([f.value.Py,f.value.Px],{icon:n}).addTo(S).bindPopup(f.value.Name).openPopup(),Q(o,a)}function Q(a,n){if(!S||!I.value.length)return;const o=b.markerClusterGroup();I.value.forEach(i=>{const x=b.marker([i.Py,i.Px],{icon:a});x.on("click",()=>{const u=document.querySelector("#description");u&&we(n?$t:st,{item:i}).mount(u)}),o.addLayer(x)}),S.addLayer(o)}E(async()=>{try{const n=await(await fetch(`${h.api.hotel}`)).json();k.value=n.XML_Head.Infos.Info.map(u=>({...u,Region:u.Region===null?u.Add.slice(0,3):u.Region,Pictures:[u.Picture1,u.Picture2,u.Picture3].filter(Boolean),PicDescribes:[u.Picdescribe1,u.Picdescribe2,u.Picdescribe3].filter(Boolean)}));const i=await(await fetch(`${h.api.scenic}`)).json();y.value=i.XML_Head.Infos.Info.map(u=>({...u,Region:u.Region===null?u.Add.slice(0,3):u.Region,Pictures:[u.Picture1,u.Picture2,u.Picture3].filter(Boolean),PicDescribes:[u.Picdescribe1,u.Picdescribe2,u.Picdescribe3].filter(Boolean)}));const x=new Date().getDate();m.value=X([...k.value],x),y.value=X([...y.value],x),d.value=[...new Set(k.value.map(u=>u.Region))],J.query.city&&(d.value.includes(J.query.city)?(c.value=J.query.city,$.value=!1):(c.value="",V()))}catch(a){console.error("Error fetching data:",a)}finally{setTimeout(()=>{v.value=!1},1600)}}),xe(c,a=>{$.value=!1,V()});function V(){le.push({query:{city:c.value||void 0}})}const U=a=>a<3e3?"text-emerald-500":a>9e3?"text-pink-700":"",fe=a=>{const{LowestPrice:n,CeilingPrice:o}=a;return`價位：${n===o?`<span class="${U(o)}">${o}</span>`:`<span class="${U(n)}">${n}</span> ~ <span class="${U(o)}">${o}</span>`}。`};return(a,n)=>{const o=Ce;return l(),s(C,null,[e("div",null,[R(Ie),e("main",null,[n[7]||(n[7]=e("h1",{class:"text-center py-[5rem] text-cyan-500 text-4xl"},"找住宿？找景點？",-1)),e("div",Pt,[e("button",{class:"bg-violet-700 text-violet-50 text-2xl px-5 py-3 min-w-80 rounded-full cursor-pointer",type:"button",onClick:re},r(_.value?"改用景點找住宿地點":"改用旅宿找附近景點"),1)]),_.value?(l(),s("div",wt,[e("div",It,[e("label",St,[q(e("select",{class:"city-select",id:"city-select","onUpdate:modelValue":n[0]||(n[0]=i=>c.value=i),onChange:V},[n[3]||(n[3]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[4]||(n[4]=e("option",{value:""},"全部",-1)),(l(!0),s(C,null,N(d.value,i=>(l(),s("option",{key:i,value:i},r(i),9,Tt))),128))],544),[[Y,c.value]])])]),e("div",null,[e("ul",Ct,[R(o,null,{default:O(()=>[(l(!0),s(C,null,N(ae.value,i=>(l(),W(ee,{key:i.Id,item:i,onClick:x=>K(i,"hotel")},{default:O(()=>[e("div",Lt,r(i.Name),1),e("p",Mt,r(i.Add),1),e("ul",null,[e("li",null,"共有 "+r(i.TotalNumberofRooms)+" 間房間。",1),e("li",{innerHTML:fe(i)},null,8,Dt)])]),_:2},1032,["item","onClick"]))),128))]),_:1})])])])):(l(),s("div",Rt,[e("div",Nt,[e("label",Ot,[q(e("select",{class:"city-select",id:"scenic-city-select","onUpdate:modelValue":n[1]||(n[1]=i=>c.value=i),onChange:V},[n[5]||(n[5]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[6]||(n[6]=e("option",{value:""},"全部",-1)),(l(!0),s(C,null,N(d.value,i=>(l(),s("option",{key:i,value:i},r(i),9,At))),128))],544),[[Y,c.value]])])]),e("div",null,[e("ul",Et,[R(o,null,{default:O(()=>[(l(!0),s(C,null,N(oe.value,i=>(l(),W(ee,{key:i.Id,item:i,onClick:x=>K(i,"scenic")},{default:O(()=>[e("div",Ht,r(i.Name),1),e("p",jt,r(i.Add),1)]),_:2},1032,["item","onClick"]))),128))]),_:1})])])]))]),R(Se)]),R(Ae,{isOpen:!!f.value,onClose:de},{default:O(()=>{var i;return[e("h2",Vt,r((i=f.value)==null?void 0:i.Name),1),e("div",Bt,[q(e("input",{id:"range-input",type:"range",min:"5",max:"20",list:"dl","onUpdate:modelValue":n[2]||(n[2]=x=>T.value=x),onInput:Z},null,544),[[$e,T.value]]),n[8]||(n[8]=e("output",{for:"range-input"},"10",-1)),e("label",qt,"方圓 "+r(T.value)+" 公里內的"+r(w.value==="hotel"?"景點":"旅宿"),1)]),n[9]||(n[9]=e("div",{id:"map-wrapper"},[e("div",{id:"map"})],-1)),e("div",Ft,[(l(),W(Pe(D.value?"DetailHotel":"DetailScenic"),{item:f.value},null,8,["item"]))])]}),_:1},8,["isOpen"]),R(o,null,{default:O(()=>[R(Me,{loading:v.value},null,8,["loading"])]),_:1})],64)}}};export{Xt as default};
