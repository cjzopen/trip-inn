const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./aTa61G_T.js","./CqkleIqs.js","./CQgsVD5f.js"])))=>i.map(i=>d[i]);
import{k as q,m as G,q as V,v as ge,c as o,o as n,a as e,_ as he,s as $,x as te,d as pe,t as a,y as B,z as N,j as g,A as ie,F as T,r as R,B as ye,C as be,D as ke,b as H,E as Y,w as z,G as W,H as xe,I as $e,J as j,K as Pe}from"./pm4d_fiS.js";import{_ as _e,F as we}from"./vCYfGy0D.js";import{u as se}from"./BdJm-Z0F.js";import"./jKaIgLMj.js";const Ie={id:"loading","aria-hidden":"true"},Se={__name:"Loading",props:{loading:{type:Boolean,required:!0}},setup(t){return q(async()=>{await G();const b=document.getElementById("loading"),h=document.querySelector(".loading-wave");b&&h&&(h.classList.add("active"),await G(),b.classList.add("active"))}),(b,h)=>V((n(),o("div",Ie,h[0]||(h[0]=[e("div",{class:"loading-wave"},null,-1),e("p",null,"載入中...",-1)]),512)),[[ge,t.loading]])}},Ce={key:0,class:"modal"},Te={class:"modal-wrapper"},Me={class:"model-content"},De={__name:"Modal",props:{isOpen:Boolean},setup(t){return(b,h)=>t.isOpen?(n(),o("div",Ce,[e("div",Te,[e("span",{class:"close",onClick:h[0]||(h[0]=v=>b.$emit("close"))},"×"),e("div",Me,[te(b.$slots,"default",{},void 0,!0)])])])):$("",!0)}},Le=he(De,[["__scopeId","data-v-e17ff7bf"]]),Re={class:"geo-label","aria-hidden":"true"},Ne={class:"figure shrink-0 w-full h-48 lg:w-[200px] lg:h-[200px] *:w-full *:h-full"},Oe=["src","alt"],Ae={class:"p-2"},ee={__name:"Card",props:{item:Object},emits:["click"],setup(t,{emit:b}){const v=se().domainUrl,I=b;return(y,f)=>(n(),o("li",{class:"card overflow-hidden rounded-xl bg-white shadow-md max-w-[480px] lg:flex",onClick:f[0]||(f[0]=c=>I("click",t.item))},[e("span",Re,[f[1]||(f[1]=e("svg",{class:"geo-label-icon",role:"presentation","aria-hidden":"true"},[e("use",{href:"#pin"})],-1)),pe(" "+a(t.item.Region)+a(t.item.Town),1)]),e("figure",Ne,[e("img",{src:t.item.Pictures[0]||`${B(v)}/images/default.webp`,alt:t.item.Name},null,8,Oe)]),e("div",Ae,[te(y.$slots,"default")])]))}},Ee={key:0},He={class:"text-2xl font-bold mb-2"},je={class:"relative w-8 h-8 my-1"},Ve=["data-id"],Be={class:"model-photos flex"},qe=["href"],Fe=["src","alt","title"],Je={class:"mb-2"},Ue={key:0,class:"mb-2"},ze={key:1,class:"mb-2"},We={class:"mb-2"},Ge={key:1,class:"mb-2"},Xe={class:"list-disc mb-2"},Ze={key:3},Ke={key:4},Qe={key:5,class:"mb-2"},Ye=["href"],et={key:1},tt={__name:"DetailHotel",props:{item:Object},setup(t){const b=t,h=N(()=>b.item??{}),v=g(!1);q(()=>{const c=JSON.parse(localStorage.getItem("favorites")||"[]");v.value=c.some(d=>d.type==="hotel"&&d.Id===item.Id)});const I=h.value.Serviceinfo?h.value.Serviceinfo.split(",").filter(c=>c.trim()!==""):[],y=h.value.Spec?h.value.Spec.split(";").filter(c=>c.trim()!=="").join("、"):"",f=c=>{const d=JSON.parse(localStorage.getItem("favorites")||"[]"),x=c.currentTarget.getAttribute("data-id"),m=c.currentTarget;if(v.value){const P=d.filter(_=>!(_.type==="hotel"&&_.Id===x));localStorage.setItem("favorites",JSON.stringify(P)),v.value=!1}else d.push({...h.value,type:"hotel"}),localStorage.setItem("favorites",JSON.stringify(d)),v.value=!0,m.classList.add("animate"),setTimeout(()=>{m.classList.remove("animate")},300)};return(c,d)=>{var x,m,P,_,C,M;return t.item?(n(),o("div",Ee,[e("h2",He,a(t.item.Name),1),e("div",je,[e("button",{onClick:d[0]||(d[0]=k=>f(k)),class:"heart-icon w-8 h-8 bg-transparent rounded-full flex items-center justify-center cursor-pointer transition-transform duration-300 focus:outline-none","aria-label":"加入收藏","data-id":t.item.Id},[(n(),o("svg",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:ie(["h-6 w-6",{"text-rose-500":v.value,"text-gray-300":!v.value,"fill-rose-500":v.value,"fill-gray-300":!v.value}])},d[1]||(d[1]=[e("use",{href:"#heart"},null,-1)]),2))],8,Ve)]),e("address",null,a(t.item.Add),1),e("div",Be,[(n(!0),o(T,null,R(t.item.Pictures,(k,L)=>(n(),o("figure",null,[e("a",{href:k,target:"_blank",rel:"noopener noreferrer"},[(n(),o("img",{key:L,src:k,alt:t.item.PicDescribes[L]||"業主提供的住宿環境照片",title:t.item.PicDescribes[L]||""},null,8,Fe))],8,qe)]))),256))]),e("p",Je,a(t.item.Description||""),1),(x=t.item)!=null&&x.LowestPrice?(n(),o(T,{key:0},[t.item.LowestPrice===t.item.CeilingPrice?(n(),o("p",Ue,"價位："+a(t.item.CeilingPrice)+" 元。",1)):(n(),o("p",ze,"價位："+a(t.item.LowestPrice)+" ~ "+a(t.item.CeilingPrice)+" 元。",1))],64)):$("",!0),e("p",We,"房間數："+a((m=t.item)==null?void 0:m.TotalNumberofRooms),1),B(y)?(n(),o("p",Ge,"特殊房型與價格："+a(B(y)),1)):$("",!0),(P=t.item)!=null&&P.Serviceinfo?(n(),o(T,{key:2},[d[2]||(d[2]=e("h3",{class:"text-lg font-bold"},"服務：",-1)),e("ul",Xe,[(n(!0),o(T,null,R(B(I),(k,L)=>(n(),o("li",{key:L},a(k),1))),128))])],64)):$("",!0),(_=t.item)!=null&&_.Tel?(n(),o("p",Ze,"電話："+a(t.item.Tel),1)):$("",!0),(C=t.item)!=null&&C.IndustryEmail?(n(),o("p",Ke,"Email："+a(t.item.IndustryEmail),1)):$("",!0),(M=t.item)!=null&&M.Website?(n(),o("p",Qe,[e("a",{class:"text-sky-600",href:t.item.Website,target:"_blank",rel:"noopener noreferrer"},"商家網站",8,Ye)])):$("",!0)])):(n(),o("div",et,d[3]||(d[3]=[e("p",null,"沒有資料",-1)])))}}},it={key:0},st={class:"text-2xl font-bold mb-2"},nt={class:"relative w-8 h-8 my-1"},ot=["data-id"],lt={class:"model-photos flex"},at=["href"],rt=["src","alt","title"],ct={class:"mb-2"},ut={key:0,class:"mb-2"},dt={key:1,class:"mb-2"},mt={key:2,class:"mb-2"},vt={key:3,class:"mb-2"},ft={key:4,class:"mb-2"},gt={key:5,class:"mb-2"},ht=["href"],pt={key:6,class:"mb-2"},yt={key:1},bt={__name:"DetailScenic",props:{item:Object},setup(t){const b=t,h=N(()=>b.item??{}),v=g(!1);q(()=>{const y=JSON.parse(localStorage.getItem("favorites")||"[]");v.value=y.some(f=>f.type==="scenic"&&f.Id===item.Id)});const I=y=>{const f=JSON.parse(localStorage.getItem("favorites")||"[]"),c=y.currentTarget.getAttribute("data-id"),d=y.currentTarget;if(v.value){const x=f.filter(m=>!(m.type==="scenic"&&m.Id===c));localStorage.setItem("favorites",JSON.stringify(x)),v.value=!1}else f.push({...h.value,type:"scenic"}),localStorage.setItem("favorites",JSON.stringify(f)),v.value=!0,d.classList.add("animate"),setTimeout(()=>{d.classList.remove("animate")},300)};return(y,f)=>{var c,d,x,m,P,_,C;return t.item?(n(),o("div",it,[e("h2",st,a(t.item.Name),1),e("div",nt,[e("button",{onClick:f[0]||(f[0]=M=>I(M)),class:"heart-icon w-8 h-8 bg-transparent rounded-full flex items-center justify-center cursor-pointer transition-transform duration-300 focus:outline-none","aria-label":"加入收藏","data-id":t.item.Id},[(n(),o("svg",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:ie(["h-6 w-6",{"text-rose-500":v.value,"text-gray-300":!v.value,"fill-rose-500":v.value,"fill-gray-300":!v.value}])},f[1]||(f[1]=[e("use",{href:"#heart"},null,-1)]),2))],8,ot)]),e("address",null,a(t.item.Add),1),e("div",lt,[(n(!0),o(T,null,R(t.item.Pictures,(M,k)=>(n(),o("figure",null,[e("a",{href:M,target:"_blank",rel:"noopener noreferrer"},[(n(),o("img",{key:k,src:M,alt:t.item.PicDescribes[k]||t.item.Name,title:t.item.PicDescribes[k]||""},null,8,rt))],8,at)]))),256))]),e("p",ct,a(t.item.Toldescribe||""),1),(c=t.item)!=null&&c.Opentime?(n(),o("p",ut,"開放時間："+a(t.item.Opentime),1)):$("",!0),(d=t.item)!=null&&d.Ticketinfo?(n(),o("p",dt,"入場費："+a(t.item.Ticketinfo),1)):$("",!0),(x=t.item)!=null&&x.Travellinginfo?(n(),o("p",mt,"大眾交通資訊："+a(t.item.Travellinginfo),1)):$("",!0),(m=t.item)!=null&&m.Parkinginfo?(n(),o("p",vt,"停車資訊："+a(t.item.Parkinginfo),1)):$("",!0),(P=t.item)!=null&&P.Tel?(n(),o("p",ft,"電話："+a(t.item.Tel),1)):$("",!0),(_=t.item)!=null&&_.Website?(n(),o("p",gt,[e("a",{class:"text-sky-600",href:t.item.Website,target:"_blank",rel:"noopener noreferrer"},"官方網站",8,ht)])):$("",!0),(C=t.item)!=null&&C.Remarks?(n(),o("p",pt,"注意事項："+a(t.item.Remarks),1)):$("",!0)])):(n(),o("div",yt,f[2]||(f[2]=[e("p",null,"沒有資料",-1)])))}}},kt={class:"text-center pb-5"},xt={key:0,id:"hotel-area",class:"pt-5"},$t={class:"text-center mb-5"},Pt={for:"city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},_t=["value"],wt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},It={class:"title text-2xl font-bold mb-2"},St={class:"min-h-[48px]"},Ct=["innerHTML"],Tt={key:1,id:"scenic-area",class:"pt-5"},Mt={class:"text-center mb-5"},Dt={for:"scenic-city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},Lt=["value"],Rt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Nt={class:"title text-xl font-bold mb-2"},Ot={class:"min-h-[48px]"},At={class:"text-2xl"},Et={class:"range-wrap",style:{"--min":"5","--max":"20","--val":"10"}},Ht={for:"range-input"},jt={id:"description"},Ut={__name:"index",setup(t){const b=se(),h=b.domainUrl;g("台灣住宿與景點資訊"),g("根據政府提供的資訊，從景點附近整理出台灣各地的民宿、旅店、旅館。");const v=g([]),I=g([]),y=g([]),f=g(!0),c=g(""),d=g([]),x=g(!0);g(null),g(null);const m=g(null),P=g("");g([]);const _=g([]),C=g(10),M=g([]),k=g(!0),L=g(!0),O=g({iconUrl:`${h}/images/taiwan/home.svg`,iconSize:[27,24],iconAnchor:[14,14]}),A=g({iconUrl:`${h}/images/taiwan/pin.svg`,iconSize:[21,28],iconAnchor:[10,18]});let S,p;const F=ye(),ne=ke(),oe=N(()=>c.value?I.value.filter(l=>l.Region===c.value):v.value),le=N(()=>x.value?v.value.slice(0,15):oe.value),ae=N(()=>c.value?y.value.filter(l=>l.Region===c.value):y.value.slice(0,15));function re(){k.value=!k.value,c.value||(x.value=!0)}function X(l,s){let i=l.length,u,w;for(;i;)w=Math.floor(ce(s)*i--),u=l[i],l[i]=l[w],l[w]=u,++s;return l}function ce(l){const s=Math.sin(l)*1e4;return s-Math.floor(s)}function ue(l,s,i,u){const r=(i-l)*Math.PI/180,D=(u-s)*Math.PI/180,U=Math.sin(r/2)*Math.sin(r/2)+Math.cos(l*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(D/2)*Math.sin(D/2);return 6371*(2*Math.atan2(Math.sqrt(U),Math.sqrt(1-U)))}function Z(){if(!m.value)return;const s=P.value==="hotel"?y.value:I.value;_.value=s.filter(i=>ue(m.value.Py,m.value.Px,i.Py,i.Px)<=C.value),M.value=_.value.map(i=>[i.Py,i.Px,{name:i.Name}]),ve()}function K(l,s){m.value=l,P.value=s,Z(),G(()=>{me(l.Py,l.Px)})}function de(){m.value=null}async function me(l,s){p||(p=await j(()=>import("./aTa61G_T.js").then(D=>D.l),__vite__mapDeps([0,1]),import.meta.url).then(D=>D.default)),await j(()=>import("./CQgsVD5f.js").then(D=>D.l),__vite__mapDeps([2,1]),import.meta.url),S&&S.remove();const i=P.value==="hotel",u=i?p.icon(O.value):p.icon(A.value),w=i?p.icon(A.value):p.icon(O.value);S=p.map("map").setView([l,s],13),p.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:10,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(S),p.marker([l,s],{icon:u}).addTo(S).bindPopup(m.value.Name).openPopup(),Q(w,i)}async function ve(){if(p||(p=await j(()=>import("./aTa61G_T.js").then(u=>u.l),__vite__mapDeps([0,1]),import.meta.url).then(u=>u.default)),await j(()=>import("./CQgsVD5f.js").then(u=>u.l),__vite__mapDeps([2,1]),import.meta.url),!S||(S.eachLayer(u=>{u instanceof p.Marker&&S.removeLayer(u)}),!m.value))return;const l=P.value==="hotel",s=l?p.icon(O.value):p.icon(A.value),i=l?p.icon(A.value):p.icon(O.value);p.marker([m.value.Py,m.value.Px],{icon:s}).addTo(S).bindPopup(m.value.Name).openPopup(),Q(i,l)}function Q(l,s){if(!S||!_.value.length)return;const i=p.markerClusterGroup();_.value.forEach(u=>{const w=p.marker([u.Py,u.Px],{icon:l});w.on("click",()=>{const r=document.querySelector("#description");r&&Pe(s?bt:tt,{item:u}).mount(r)}),i.addLayer(w)}),S.addLayer(i)}q(async()=>{try{const s=await(await fetch(`${b.api.hotel}`)).json();I.value=s.XML_Head.Infos.Info.map(r=>({...r,Region:r.Region===null?r.Add.slice(0,3):r.Region,Pictures:[r.Picture1,r.Picture2,r.Picture3].filter(Boolean),PicDescribes:[r.Picdescribe1,r.Picdescribe2,r.Picdescribe3].filter(Boolean)}));const u=await(await fetch(`${b.api.scenic}`)).json();y.value=u.XML_Head.Infos.Info.map(r=>({...r,Region:r.Region===null?r.Add.slice(0,3):r.Region,Pictures:[r.Picture1,r.Picture2,r.Picture3].filter(Boolean),PicDescribes:[r.Picdescribe1,r.Picdescribe2,r.Picdescribe3].filter(Boolean)}));const w=new Date().getDate();v.value=X([...I.value],w),y.value=X([...y.value],w),d.value=[...new Set(I.value.map(r=>r.Region))],F.query.city&&(d.value.includes(F.query.city)?(c.value=F.query.city,x.value=!1):(c.value="",E()))}catch(l){console.error("Error fetching data:",l)}finally{setTimeout(()=>{f.value=!1},1600)}}),be(c,l=>{x.value=!1,E()});function E(){ne.push({query:{city:c.value||void 0}})}const J=l=>l<3e3?"text-emerald-500":l>9e3?"text-pink-700":"",fe=l=>{const{LowestPrice:s,CeilingPrice:i}=l;return`價位：${s===i?`<span class="${J(i)}">${i}</span>`:`<span class="${J(s)}">${s}</span> ~ <span class="${J(i)}">${i}</span>`}。`};return(l,s)=>(n(),o(T,null,[e("div",null,[H(_e),e("main",null,[s[7]||(s[7]=e("h1",{class:"text-center py-[5rem] text-cyan-500 text-4xl"},"找住宿？找景點？",-1)),e("div",kt,[e("button",{class:"bg-violet-700 text-violet-50 text-2xl px-5 py-3 min-w-80 rounded-full cursor-pointer",type:"button",onClick:re},a(k.value?"改用景點找住宿地點":"改用旅宿找附近景點"),1)]),k.value?(n(),o("div",xt,[e("div",$t,[e("label",Pt,[V(e("select",{class:"city-select",id:"city-select","onUpdate:modelValue":s[0]||(s[0]=i=>c.value=i),onChange:E},[s[3]||(s[3]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),s[4]||(s[4]=e("option",{value:""},"全部",-1)),(n(!0),o(T,null,R(d.value,i=>(n(),o("option",{key:i,value:i},a(i),9,_t))),128))],544),[[Y,c.value]])])]),e("div",null,[e("ul",wt,[(n(!0),o(T,null,R(le.value,i=>(n(),W(ee,{key:i.Id,item:i,onClick:u=>K(i,"hotel")},{default:z(()=>[e("div",It,a(i.Name),1),e("p",St,a(i.Add),1),e("ul",null,[e("li",null,"共有 "+a(i.TotalNumberofRooms)+" 間房間。",1),e("li",{innerHTML:fe(i)},null,8,Ct)])]),_:2},1032,["item","onClick"]))),128))])])])):(n(),o("div",Tt,[e("div",Mt,[e("label",Dt,[V(e("select",{class:"city-select",id:"scenic-city-select","onUpdate:modelValue":s[1]||(s[1]=i=>c.value=i),onChange:E},[s[5]||(s[5]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),s[6]||(s[6]=e("option",{value:""},"全部",-1)),(n(!0),o(T,null,R(d.value,i=>(n(),o("option",{key:i,value:i},a(i),9,Lt))),128))],544),[[Y,c.value]])])]),e("div",null,[e("ul",Rt,[(n(!0),o(T,null,R(ae.value,i=>(n(),W(ee,{key:i.Id,item:i,onClick:u=>K(i,"scenic")},{default:z(()=>[e("div",Nt,a(i.Name),1),e("p",Ot,a(i.Add),1)]),_:2},1032,["item","onClick"]))),128))])])]))]),H(we)]),H(Le,{isOpen:!!m.value,onClose:de},{default:z(()=>{var i;return[e("h2",At,a((i=m.value)==null?void 0:i.Name),1),e("div",Et,[V(e("input",{id:"range-input",type:"range",min:"5",max:"20",list:"dl","onUpdate:modelValue":s[2]||(s[2]=u=>C.value=u),onInput:Z},null,544),[[xe,C.value]]),s[8]||(s[8]=e("output",{for:"range-input"},"10",-1)),e("label",Ht,"方圓 "+a(C.value)+" 公里內的"+a(P.value==="hotel"?"景點":"旅宿"),1)]),s[9]||(s[9]=e("div",{id:"map-wrapper"},[e("div",{id:"map"})],-1)),e("div",jt,[(n(),W($e(L.value?"DetailHotel":"DetailScenic"),{item:m.value},null,8,["item"]))])]}),_:1},8,["isOpen"]),H(Se,{loading:f.value},null,8,["loading"])],64))}};export{Ut as default};
